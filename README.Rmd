---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%",
  message = FALSE,
  warning = FALSE,
  fig.retina = 2,
  fig.align = 'center'
)

library(tidyverse)
library(epoxy)
library(universityrankingafrica)
library(sf)
library(rnaturalearth)
```

# universityrankingafrica

<!-- badges: start -->
<!-- badges: end -->

This packages combines data collected as part of an MSc. Thesis Project. The goal of this project was to build an openly accessible database with data from the top ranked universities of each African country.The project was supported by the Global Health Engineering group at ETH Zurich, Switzerland.

```{r, echo=FALSE}
top_ranked_per_country <- universityrankingafrica |> 
  select(University, Country, `Rank Africa`) |> 
  group_by(Country) |> 
  filter(`Rank Africa` == min(`Rank Africa`)) |> 
  ungroup()
world <- ne_countries(scale = "medium", returnclass = "sf")
africa_map <- left_join(world, 
                        top_ranked_per_country, by = c("name" = "Country")) |>  
  filter(continent == "Africa")
ggplot() +
  theme_void() +
  geom_sf(data = africa_map, aes(fill = `Rank Africa`), color = "white", lwd = 0) +
  scale_fill_gradientn(name = "Rank Africa", 
                       trans = "log",
                       labels = scales::label_number(accuracy = 1),
                       colors = c("#2E8B57","#9DBF9E", "#FCB97D", "#A84268"),
                       na.value = "grey80") +
  labs(title = "Top-Ranked Universities in Africa", ) +
  theme(legend.position = c(0, 0.4), legend.direction = "horizontal",
        plot.title = element_text(size = 20, hjust = 3, vjust = 0))
```

## Installation

You can install the development version of universityrankingafrica from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("openwashdata/universityrankingafrica")
```
Alternatively, you can download the dataset as a CSV or XLSX
file from the table below.

```{r, echo=FALSE}

extdata_path <- "https://github.com/openwashdata/universityrankingafrica/inst/extdata/"

read_csv("data-raw/dictionary.csv") |> 
  distinct(file_name) |> 
  mutate(file_name = str_remove(file_name, ".rda")) |> 
  rename(dataset = file_name) |> 
  mutate(
    CSV = paste0("[Download CSV](", extdata_path, dataset, ".csv)"),
    XLSX = paste0("[Download XLSX](", extdata_path, dataset, ".xlsx)")
  ) |> 
  knitr::kable()

```

## MSc. Thesis Project
### Description and Research Question
For research at GHE about African universities and their performance on an international scale,
a comprehensive database was needed. Such a database would also prove useful to gain a broad picture of
the institutions present on the continent, and potential new opportunities for academic collaborations.
The first research question that can be tackled after the data collection is “Which attributes of an African
university correlate with its performance in an international ranking?”.

### Data
For the data collection at hand, it was decided to only consider the 3 (at most) highest ranked
universities of each African country. The gathered data offers interesting insights into the African academic landscape, mostly
through the process of combing through more than 140 websites in the search for information.
Generally, this data collection process gets more and more difficult the further down the ranking
performance goes: Navigation is more confusing and useful information scarcer. Assisting institutions
in improving the quality of their web contents could be one possible avenue for cooperation with
African universities in the future.

The package provides access to one data set.
```{r}
library(universityrankingafrica)
```

```{epoxy}
The `universityrankingafrica` data set has {ncol(universityrankingafrica)} variables and {nrow(universityrankingafrica)} observations. For an overview of the variable names, see the following table.  

```

```{r, eval=FALSE}
universityrankingafrica
```

```{r, echo=FALSE}
readr::read_csv("data-raw/dictionary.csv") |>  
  dplyr::select(variable_name:description) |> 
  knitr::kable()
```

## Example

### Idea 1
Our first try is to select the highest ranked university in each country and use only those to rank the countries. 

```{r}
library(universityrankingafrica)
library(tidyverse)
library(sf)
library(rnaturalearth)


top_ranked_per_country <- universityrankingafrica |> 
  select(University, Country, `Rank Africa`) |> 
  group_by(Country) |> 
  filter(`Rank Africa` == min(`Rank Africa`)) |> 
  ungroup()

world <- ne_countries(scale = "medium", returnclass = "sf")

africa_map <- left_join(world, 
                        top_ranked_per_country, by = c("name" = "Country")) |>  
  filter(continent == "Africa")

plot <- ggplot() +
  theme_void() +
  geom_sf(data = africa_map, aes(fill = `Rank Africa`), color = "white", lwd = 0) +
  scale_fill_gradientn(name = "Rank Africa", 
                       trans = "log",
                       labels = scales::label_number(accuracy = 1),
                       colors = c("#2E8B57","#9DBF9E", "#FCB97D", "#A84268"),
                       na.value = "grey80") +
  labs(title = "Top-Ranked Universities in Africa", ) +
  theme(legend.position = c(0, 0.4), legend.direction = "horizontal",
        plot.title = element_text(size = 20, hjust = 3, vjust = 0))

plot
ggsave("plot/africa_map_1.png", plot, width = 10, height = 8, dpi = 300)

```

### Idea 2

This analysis investigates whether a correlation exists between the colonial power that previously governed African nations and their current university rankings.  

```{r}
library(universityrankingafrica)
library(tidyverse)

data <- universityrankingafrica |> 
  filter(`Colonial Power at Independence` %in% c("United Kingdom", "France", "Belgium", "Italy", "Portugal"))

# Create a scatter plot
ggplot(data, aes(x = `Colonial Power at Independence`, y = `Rank Africa`)) +
  geom_point() +
  labs(x = "Colonial Power at Independence", y = "Africa Rank") +
  ggtitle("University Ranking in Africa vs Colonial Power at Independence")

# Perform linear regression
model <- lm(`Rank Africa` ~ `Colonial Power at Independence`, data = data)
print(summary(model))
```
#### Interpretation

The model doesn't provide strong evidence that the specific colonial powers (France, Italy, Portugal, United Kingdom) significantly predict the university rankings in Africa based on their p-values which are greater than conventional thresholds like 0.05.. The low R-squared value indicates that the model might not explain much of the variability in the university rankings, suggesting that factors beyond colonial power might influence these rankings significantly.


## License

Data are available as 
[CC-BY](https://github.com/openwashdata/universityrankingafrica/LICENSE.md).

## Citation

To cite this package, please use:

```{r}
citation("universityrankingafrica")
```
